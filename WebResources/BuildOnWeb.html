<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Build On Web</title>
    <link rel="stylesheet" href="css/layout.css">
</head>
<body>
    <div id="Container">
	<div id="Header">This is the Header</div>
	<div id="ContentFrame">
            <div id="SourceViewFrame">
                <div id="SourcePath"></div>
                <div id="SourceView">$BOW_TMPL_SOURCE$</div>
            </div>
            <div id="OutputInfo">
                <!--form method="post" onsubmit= "return go_editor(this);">
                    <input type="submit" value="go"/>
                </form-->
            </div>
            <div id="OutPutFrame">$BOW_TMPL_OUTPUT$</div>
	</div>   
        <div id="Footer">This is the footer</div>
    </div>
    <script src="http://d1n0x3qji82z53.cloudfront.net/src-min-noconflict/ace.js" type="text/javascript" charset="utf-8"></script>
    <script>
      var output = ace.edit("OutPutFrame");
      output.setTheme("ace/theme/terminal");
      output.getSession().setMode("ace/mode/text");
      output.setReadOnly(true);
      
      var editor = ace.edit("SourceView");
      editor.setTheme("ace/theme/xcode");
      editor.getSession().setMode("ace/mode/$BOW_TMPL_TYPE$");
      editor.getSession().on('change', function(e) {
            var xmlHttpRequest = new XMLHttpRequest();
            xmlHttpRequest.onreadystatechange = function()
            {
                var READYSTATE_COMPLETED = 4;
                var HTTP_STATUS_OK = 200;
/*
                console.log(xmlHttpRequest.readyState);
                console.log(xmlHttpRequest.status);
*/
                if( xmlHttpRequest.readyState == READYSTATE_COMPLETED
                    && xmlHttpRequest.status == HTTP_STATUS_OK )
                {
/*
                    console.log( xmlHttpRequest.responseText );
*/
                    output.setValue(xmlHttpRequest.responseText,1);
                }
            }
            xmlHttpRequest.open('POST','/EventAceOnChange/$BOW_TMPL_PATH$');
            xmlHttpRequest.setRequestHeader( 'Content-Type', 'application/x-www-form-urlencoded');
            xmlHttpRequest.send( editor.getValue() );
      });
    </script>
</body>
</html>
